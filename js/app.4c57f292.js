(function(t){function e(e){for(var r,i,s=e[0],c=e[1],u=e[2],l=0,m=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&m.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);d&&d(e);while(m.length)m.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a=[];function i(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"8733d55a"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n=o[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=o[t]=[e,r]}));e.push(n[2]=r);var a,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=i(t);var u=new Error;a=function(e){c.onerror=c.onload=null,clearTimeout(l);var n=o[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",u.name="ChunkLoadError",u.type=r,u.request=a,n[1](u)}o[t]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:c})}),12e4);c.onerror=c.onload=a,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1615:function(t,e,n){"use strict";var r=n("cf61"),o=n.n(r);o.a},"2bb7":function(t,e,n){},"2bde":function(t,e,n){"use strict";var r=n("97fd"),o=n.n(r);o.a},"31e2":function(t,e,n){},4361:function(t,e,n){"use strict";var r=n("31e2"),o=n.n(r);o.a},"4ffd":function(t,e){t.exports="data:image/png;base64,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"},5452:function(t,e,n){"use strict";var r=n("af35"),o=n.n(r);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,o,a,i,s=n("2b0e"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.isBurgerMenu?"padding-left":null,attrs:{id:"app"}},[n("Header",{attrs:{isBurgerMenu:t.isBurgerMenu}}),n("router-view")],1)},u=[],l=(n("caad"),n("b0c0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isBurgerMenu?n("header",{staticClass:"isVertical"},[n("nav",{attrs:{role:"navigation"}},[t._m(0),n("ul",{staticClass:"nav flex-column"},[n("li",{staticClass:"navbar-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Accueil")])],1),n("li",{staticClass:"navbar-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Voter")])],1),t.isLogged&&t.currentUser?n("li",{staticClass:"navbar-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/account/"+t.currentUser._id}},[t._v("Mon compte")])],1):t._e(),n("li",{staticClass:"navbar-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Le scrutin majoritaire")])],1),n("li",{staticClass:"navbar-item mb-4"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/about"}},[t._v("À propos")])],1),t.isLogged?n("li",{staticClass:"navbar-item"},[n("form",{attrs:{id:"logoutForm"},on:{submit:t.logout}},[n("button",{staticClass:"btn btn-link text-danger",attrs:{type:"submit",value:"Submit"}},[t._v("Déconnexion")])])]):t._e()])])]):n("header",[n("nav",{staticClass:"navbar navbar-expand-lg navbar-light bg-light fixed-top",attrs:{role:"navigation"}},[n("a",{staticClass:"navbar-brand",attrs:{href:"/"}},[t._v("Voton")]),t._m(1),n("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarSupportedContent"}},[n("ul",{staticClass:"navbar-nav mr-auto"},[n("li",{staticClass:"nav-item active"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Accueil")])],1),n("li",{staticClass:"nav-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Voter")])],1),n("li",{staticClass:"nav-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/scrutin-majoritaire"}},[t._v("Le scrutin majoritaire")])],1),n("li",{staticClass:"nav-item"},[n("router-link",{staticClass:"nav-link",attrs:{to:"/about"}},[t._v("À propos")])],1)])])])])}),d=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a",{staticClass:"navbar-brand mb-4",attrs:{href:"#"}},[r("img",{staticClass:"d-inline-block align-top",attrs:{src:n("4ffd"),width:"70",alt:""}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"navbar-toggler",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"}},[n("span",{staticClass:"navbar-toggler-icon"})])}],m=(n("d3b7"),n("96cf"),n("1da1")),p=n("bc3a"),v=n.n(p),f={name:"ApiCalls",data:function(){return{API_URL:"https://ireneburlet.fr/votonapi/api/",API_TOKEN:"70c77d44498bbd384a81efc51ffdd1",user_token:localStorage.getItem("user-token")||"",user:localStorage.getItem("currentUser")||{}}},methods:{login:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){v.a.defaults.baseURL=e.API_URL,v.a.post("cockpit/authUser?token=".concat(e.API_TOKEN),t).then((function(t){localStorage.setItem("user-token",t.data.api_key),localStorage.setItem("currentUser",JSON.stringify(t.data)),n(t)})).catch((function(t){r(t)}))})));case 1:case"end":return n.stop()}}),n)})))()},logout:function(){var t=this;return Object(m["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:localStorage.removeItem("currentUser"),localStorage.removeItem("user-token"),t.$router.push("/");case 3:case"end":return e.stop()}}),e)})))()},saveUser:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){v.a.defaults.baseURL=e.API_URL,v.a.post("cockpit/saveUser?token=".concat(e.API_TOKEN),{user:t}).then((function(t){var e=JSON.parse(t.config.data);n({user:e.user.user,password:e.user.password})})).catch((function(t){r(t)}))})));case 1:case"end":return n.stop()}}),n)})))()},findRecord:function(t,e){var n=this;return Object(m["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){v.a.defaults.baseURL=n.API_URL,v.a.defaults.headers.common["Cockpit-Token"]=n.user_token,v.a.post("/collections/get/".concat(t),e).then((function(t){return r(t)})).catch((function(t){return o(t)}))})));case 1:case"end":return r.stop()}}),r)})))()},createOrSaveRecord:function(t,e){var n=this;return Object(m["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.abrupt("return",new Promise((function(r,o){v.a.defaults.baseURL=n.API_URL,v.a.defaults.headers.common["Cockpit-Token"]=n.user_token,v.a.post("/collections/save/".concat(t),{data:e}).then((function(t){return r(t)})).catch((function(t){return o(t)}))})));case 1:case"end":return r.stop()}}),r)})))()},removeRecord:function(t,e){return Object(m["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,r){v.a.post("/collections/remove/".concat(t),{filter:e}).then((function(t){return n(t)})).catch((function(t){return r(t)}))})));case 1:case"end":return n.stop()}}),n)})))()}}},h=f,b=n("2877"),g=Object(b["a"])(h,r,o,!1,null,null,null),C=g.exports,_={name:"Header",mixins:[C],data:function(){return{icon:"bars",isHidden:!0,currentUser:JSON.parse(localStorage.getItem("currentUser"))}},computed:{isLogged:function(){return!!localStorage.getItem("currentUser")}},props:{isBurgerMenu:{type:Boolean,default:!1}},methods:{}},w=_,x=(n("5452"),Object(b["a"])(w,l,d,!1,null,null,null)),y=x.exports,A={components:{Header:y},computed:{isBurgerMenu:function(){return!!localStorage.getItem("currentUser")||["Vote","CreateAnonymVote"].includes(this.$route.name)}}},k=A,S=(n("5c0b"),Object(b["a"])(k,c,u,!1,null,null,null)),P=S.exports,V=n("8c4f"),O=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row main-container",attrs:{id:"content"}},[r("div",{staticClass:"col-3 col-lg-4 text-center my-auto",attrs:{id:"description"}},[r("img",{staticClass:"mb-5",attrs:{src:n("4ffd"),alt:"",width:"175px;"}}),r("h2",{staticClass:"mb-4"},[t._v("Le scrutin majoritaire pour tous")]),t._m(0),r("button",{staticClass:"btn btn-primary",on:{click:t.createAnonymVote}},[t._v("Créer un vote")])]),r("div",{staticClass:"col cards-ctn card-columns my-auto"},[r("small-card-form",{attrs:{title:"Connexion",subTitle:"Accéder à mon compte",buttonSubmitText:"Me connecter",error:t.errorAuthentication,submitMethod:t.authentication}},[r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"loginUsername"}},[t._v("Nom d'utilisateur")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.loginUsername,expression:"loginUsername"}],staticClass:"form-control",attrs:{type:"text",id:"loginUsername",placeholder:"Nom d'utilisateur",name:"loginUsername",required:""},domProps:{value:t.loginUsername},on:{input:function(e){e.target.composing||(t.loginUsername=e.target.value)}}})]),r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"loginPassword"}},[t._v("Mot de passe")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.loginPassword,expression:"loginPassword"}],staticClass:"form-control",attrs:{type:"password",id:"loginPassword",placeholder:"Mot de passe",name:"loginPassword",pattern:"[^'\\x22\\s]{5,}",title:"Espaces et apostrophes non autorisés",required:""},domProps:{value:t.loginPassword},on:{input:function(e){e.target.composing||(t.loginPassword=e.target.value)}}}),r("small",{staticClass:"form-text text-muted"},[t._v("5 caractères minimum")])]),r("a",{staticClass:"d-block small mt-3",attrs:{slot:"link",href:"",onclick:t.reset_password()},slot:"link"},[t._v("Identifiant ou mot de passe oublié ?")])]),r("small-card-form",{attrs:{title:"Inscription",subTitle:"Créez un compte pour pouvoir sauvegarder vos votes",buttonSubmitText:"M'inscrire",error:t.errorSignin,submitMethod:t.createUser}},[r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"create-username"}},[t._v("Nom d'utilisateur")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.createUsername,expression:"createUsername"}],staticClass:"form-control",attrs:{type:"text",id:"create-username",placeholder:"Ex: d4rkl0rd73",name:"create-username",pattern:"[A-Za-z0-9_\\-]{1,}",title:"Pas de caractères spéciaux",required:""},domProps:{value:t.createUsername},on:{input:function(e){e.target.composing||(t.createUsername=e.target.value)}}})]),r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"create-email"}},[t._v("Email")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.createEmail,expression:"createEmail"}],staticClass:"form-control",attrs:{type:"email",id:"create-email",placeholder:"Entrez un email valide",name:"create-email",pattern:"[^'\\x22\\s]{5,}",title:"Espaces et apostrophes non autorisés",required:""},domProps:{value:t.createEmail},on:{input:function(e){e.target.composing||(t.createEmail=e.target.value)}}})]),r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"create-password"}},[t._v("Mot de passe")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.createPassword,expression:"createPassword"}],staticClass:"form-control",attrs:{type:"password",id:"create-password",placeholder:"Mot de passe",name:"create-password",pattern:"[^'\\x22\\s]+",title:"Espaces et apostrophes non autorisés",min:"6",required:""},domProps:{value:t.createPassword},on:{input:function(e){e.target.composing||(t.createPassword=e.target.value)}}}),r("small",{staticClass:"form-text text-muted"},[t._v("5 caractères minimum")])]),r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"create-password2"}},[t._v("Confirmation du mot de passe")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],staticClass:"form-control",class:{"border-danger":t.pswdNotEqual},attrs:{type:"password",id:"create-password2",placeholder:"Mot de passe",name:"create-password2",pattern:"[^'\\x22\\s]{5,}",title:"Espaces et apostrophes non autorisés",min:"6",required:""},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}})])]),r("small-card-form",{attrs:{title:"Répondre à une invitation",subTitle:"Rejoindre un vote en cours via un lien d'invitation",buttonSubmitText:"Rejoindre",submitMethod:t.joinVote}},[r("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[r("label",{attrs:{for:"link"}},[t._v("Lien d'invitation")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.voteLink,expression:"voteLink"}],staticClass:"form-control",attrs:{type:"url",id:"link_vote",placeholder:"https://voton.com/vote/numeroduvote...",name:"link",required:""},domProps:{value:t.voteLink},on:{input:function(e){e.target.composing||(t.voteLink=e.target.value)}}})])])],1)])},j=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"px-3"},[t._v(" Avec Voton, lancez un vote en quelques clics, "),n("br"),t._v("sur la base du "),n("b",[t._v("scrutin Majoritaire")]),t._v(", un système de scrutin nouvelle génération démocratiquement et mathématiquement plus avancé que le scrutin Uninominatif à 2 tours classiques. ")])}],U=(n("ac1f"),n("5319"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card bg-light mt-1",class:t.customClass},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"mt-2 mb-4"},[n("h4",{staticClass:"card-title mb-3 text-primary"},[t._v(t._s(t.title))]),n("p",{staticClass:"card-subtitle"},[t._v(t._s(t.subTitle))]),n("p",{staticClass:"text-danger small"},[t._v(t._s(t.error))])]),n("form",{attrs:{method:"post",autocomplete:"on"},on:{submit:t.submitCallback}},[t._t("input"),n("div",{staticClass:"form-group mb-0 mt-4"},[n("button",{staticClass:"btn btn-primary btn",attrs:{type:"submit",value:"submit"}},[t._v(t._s(t.buttonSubmitText))]),t._t("link")],2)],2)])])}),M=[],L={name:"smallCardForm",props:{title:{type:String,required:!0},subTitle:String,buttonSubmitText:{type:String,required:!0},error:String,submitMethod:{type:Function,required:!0},customClass:{type:String,required:!1}},methods:{submitCallback:function(t){t.preventDefault(),this.submitMethod()}}},E=L,N=(n("d1b4"),Object(b["a"])(E,U,M,!1,null,"438925ff",null)),R=N.exports,D=n("9612"),q={name:"Home",data:function(){return{createUsername:null,createEmail:null,createPassword:"",confirmPassword:"",loginUsername:null,loginPassword:null,errorAuthentication:null,errorSignin:null,voteLink:null}},mixins:[C],components:{SmallCardForm:R},computed:{pswdNotEqual:function(){return this.createPassword!==this.confirmPassword}},methods:{authentication:function(){var t=this,e=this.loginUsername,n=this.loginPassword;this.login({user:e,password:n}).then((function(e){t.$router.push("/account/".concat(e.data._id)).catch((function(t){console.log(t)}))})).catch((function(){t.errorAuthentication="Mauvais pseudo ou mot de passe"}))},createUser:function(){var t=this,e={name:this.createUsername,user:this.createUsername,email:this.createEmail,password:this.createPassword,group:"simpleUser",active:!0,api_key:"account-"+D["a"].v1().replace(/-/g,"")};this.saveUser(e).then((function(e){t.login(e).then((function(e){t.$router.push("/account/".concat(e.data._id))}))})).catch((function(e){console.log(e),e&&e.response&&412==e.response.status&&(t.errorSignin="Non d'utilisateur déjà existant")}))},joinVote:function(){var t=/^http[s]{0,1}:\/\/[a-zA-Z\d.]+\//g,e=this.voteLink.replace(t,"");this.$router.push(e)},createAnonymVote:function(){this.$router.push("/vote/new")},reset_password:function(){}}},I=q,B=(n("4361"),Object(b["a"])(I,O,j,!1,null,"2100ee60",null)),T=B.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?n("main-card-container",[n("div",{attrs:{slot:"content"},slot:"content"},[t._v(" Chargement... ")])]):n("main-card-container",{attrs:{title:t.vote.title}},[n("div",{staticClass:"col-8",attrs:{slot:"content"},slot:"content"},[n("h4",{staticClass:"my-4"},[t._v(t._s(t.vote.description))]),n("h5",{staticClass:"text-left"},[t._v(" "+t._s(t.vote.nbChoices)+" proposition"+t._s(t.vote.nbChoices>1?"s":"")+" ")]),n("form",{attrs:{id:"choicesForm"},on:{submit:t.submitVote}},[t._l(t.choices,(function(e,r){return n("Proposition",{key:r,attrs:{item:e,voteStatus:t.vote.status,hasAlreadyVoted:!1,choice_value:"nb6"},on:{childToParent:t.updateBulletin}})})),n("div",{staticClass:"d-flex justify-content-between"},[1==t.vote.status&&t.currentUser&&t.vote.user_id==t.currentUser._id?n("button",{staticClass:"btn btn-outline-danger d-block",attrs:{disabled:0==t.vote.nbBulletins,id:"closeVote",type:"button"},on:{click:function(e){return t.closeVote(t.vote._id)}}},[t._v("Fermer le vote")]):t._e(),1==t.vote.status?n("button",{staticClass:"btn btn-primary d-block ml-auto",attrs:{type:"submit"}},[t._v(t._s(t.hasAlreadyVoted?"A voté":"Déposer mon bulletin"))]):t._e()])],2)])])},Q=[],H=(n("4160"),n("25f0"),n("159b"),n("ddb0"),n("b85c")),J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card col-12 my-3 mx-0"},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"row mx-0 mb-2"},[n("h4",{staticClass:"card-title"},[t._v(t._s(t.item.name))]),n("h5",{staticClass:"card-subtitle mention ml-auto mt-1"},[t._v(t._s(t.mention))])]),"1"==t.voteStatus?n("div",{staticClass:"d-flex w-100 justify-content-between"},[n("font-awesome-icon",{staticClass:"text-danger",attrs:{icon:["far","frown"]}}),t._l(t.mentions,(function(e,r){return n("div",{key:t.item._id+"_"+e},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.pickedMention,expression:"pickedMention"}],attrs:{type:"radio",name:t.item._id+"_"+e},domProps:{value:r,checked:t._q(t.pickedMention,r)},on:{click:function(e){t.hasAlreadyVoted||t.updateBulletin(r)},change:function(e){t.pickedMention=r}}})])})),n("font-awesome-icon",{staticClass:"text-success",attrs:{icon:["far","smile"]}})],2):n("div",[n("font-awesome-icon",{staticClass:"text-white repere",attrs:{icon:["fas","caret-up"]}}),n("div",{staticClass:"nmb_voices_bar"},t._l(t.mentions,(function(e,r,o){return n("div",{key:t.item._id+"_"+e,style:{width:t.getWidth(o+1)+"%"}})})),0)],1)])])},W=[],z={methods:{getMajorityMention:function(t){for(var e=6,n=0,r=1;r<=e;r++)n+=parseInt(t["nbNote"+r])||0;var o=parseInt(t["nbNote"+e])||0;while(o<=n/2)e-=1,o+=parseInt(t["nbNote"+e]||0);return e},compareChoices:function(t,e,n,r,o,a){var i=n||this.getMajorityMention(t),s=r||this.getMajorityMention(e);if(1==o&&6==a)return 0;if(i===s){var c=o||i,u=this.count_gte(t,c),l=this.count_gte(e,c);if(u===l){var d=a||i,m=this.count_lte(t,d),p=this.count_lte(e,d);if(m==p){var v=1===c?1:c-1,f=6===d?6:d+1;return this.compareChoices(t,e,i-1,s-1,v,f)}return m<p?-1:1}return u>l?-1:1}return i>s?-1:1},count_gte:function(t,e){for(var n=parseInt(t["nbNote"+e]||0),r=e+1,o=r;o<=6;o++)n+=parseInt(t["nbNote"+o])||0;return n},count_lte:function(t,e){for(var n=parseInt(t["nbNote"+e])||0,r=e+1,o=r;o>0;o--)n+=parseInt(t["nbNote"+o])||0;return n},sort_choices:function(t){var e=this;return t.sort((function(t,n){var r=e.compareChoices(t,n);return r}))}}},G=z,K=Object(b["a"])(G,a,i,!1,null,null,null),Y=K.exports,X={name:"Proposition",props:{item:{type:Object,required:!0},voteStatus:String,hasAlreadyVoted:Boolean,childToParent:Function,choice_value:String},mixins:[Y],data:function(){return{mentions:{nb1:"Non",nb2:"Insuffisant",nb3:"Passable",nb4:"Neutre",nb5:"Assez bien",nb6:"Bien"},pickedMention:this.hasAlreadyVoted?this.choice_value:"nb6"}},computed:{mention:function(){return this.voteStatus<2?this.mentions[this.pickedMention]:this.mentions["nb"+this.getMajorityMention(this.item)]}},methods:{updateBulletin:function(t){this.$emit("childToParent",this.item._id,t)},getWidth:function(t){for(var e=0,n=1;n<=6;n++)e+=parseInt(this.item["nbNote"+n])||0;var r=100*(parseInt(this.item["nbNote"+t])||0)/e;return r.toString()}}},Z=X,$=(n("f4b0"),Object(b["a"])(Z,J,W,!1,null,"7adb7ea6",null)),tt=$.exports,et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"col-7 p-0 mx-auto card bg-light my-4",class:t.customClass},[n("div",{staticClass:"card-header"},[n("h3",{staticClass:"mb-0"},[t._v(t._s(t.title))])]),n("div",{staticClass:"card-body d-flex flex-column align-items-center"},[t._t("content")],2)])},nt=[],rt={name:"mainCardContainer",props:{title:{type:String,required:!1,default:"Le vote majoritaire"},customClass:{type:String,required:!1}}},ot=rt,at=Object(b["a"])(ot,et,nt,!1,null,"3f9ebc81",null),it=at.exports,st={name:"Vote",components:{Proposition:tt,MainCardContainer:it},mixins:[C,Y],data:function(){return{currentUser:JSON.parse(localStorage.getItem("currentUser")),hasAlreadyVoted:!1,ballot:{},vote:{},choices:[],choices_values:{},loading:!0}},created:function(){var t=this;this.findRecord("votes",{filter:{_id:this.$route.params.vote_id}}).then((function(e){t.vote=e.data.entries[0],t.hasAlreadyVoted=localStorage.getItem(t.vote._id)||!1,t.findRecord("choices",{filter:{vote_id:t.$route.params.vote_id}}).then((function(e){t.choices=e.data.entries,t.vote.status>1&&t.sort_choices(t.choices),e.data.entries.forEach((function(e){t.choices_values[e._id]={name:e.name,value:"nb6"}})),t.loading=!1})).catch((function(t){return console.error(t)}))})).catch((function(t){return console.error(t)})),this.currentUser&&this.findRecord("ballots",{filter:{vote_id:this.$route.params.vote_id,voting_user_id:this.currentUser._id}}).then((function(e){e.data.entries.length>0&&(t.ballot=e.data.entries[0],t.hasAlreadyVoted=!0)})).catch((function(t){return console.error(t)}))},methods:{updateBulletin:function(t,e){this.choices_values[t].value=e},submitVote:function(t){var e=this;return Object(m["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.preventDefault(),e.createOrSaveRecord("ballots",{vote_id:e.vote._id,voting_user_id:e.currentUser?e.currentUser._id:"ANONYM",choices_values:e.choices_values}).catch((function(t){return console.error(t)})),r=Object(H["a"])(e.choices),n.prev=3,r.s();case 5:if((o=r.n()).done){n.next=15;break}return a=o.value,i=e.choices_values[a._id]["value"].replace("nb",""),s="nbNote"+i,c={_id:a._id},c[s]=((parseInt(a[s])||0)+1).toString(),n.next=13,e.createOrSaveRecord("choices",c).catch((function(t){return console.error(t)}));case 13:n.next=5;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](3),r.e(n.t0);case 20:return n.prev=20,r.f(),n.finish(20);case 23:e.createOrSaveRecord("votes",{_id:e.vote._id,nbBulletins:parseInt(e.vote.nbBulletins)+1}).then((function(){e.currentUser?e.$router.push("/account/"+e.currentUser._id):localStorage.setItem("".concat(e.vote._id),!0)})).catch((function(t){return console.error(t)}));case 24:case"end":return n.stop()}}),n,null,[[3,17,20,23]])})))()},closeVote:function(t){var e=this,n=this.sort_choices(this.choices)[0]._id;this.createOrSaveRecord("votes",{_id:t,winningChoice_id:n,status:2}).then((function(){return e.$router.push("/account/"+e.currentUser._id)})).catch((function(t){return console.error(t)}))}}},ct=st,ut=Object(b["a"])(ct,F,Q,!1,null,null,null),lt=ut.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?n("main-card-container",[n("div",{attrs:{slot:"content"},slot:"content"},[t._v(" Chargement... ")])]):n("main-card-container",{attrs:{title:t.isNew?"Nouveau vote":"Édition du vote"}},[n("form",{staticClass:"col-12",attrs:{slot:"content"},on:{submit:t.openVote},slot:"content"},[n("div",{staticClass:"mb-5 col-6 mx-auto"},[n("h4",[t._v("Informations générales")]),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"title"}},[t._v("Titre")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control",attrs:{id:"title",type:"text",name:"title","aria-describedby":"emailHelp",placeholder:"Titre de votre vote",required:""},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"question"}},[t._v("Question")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",attrs:{id:"question",type:"text",name:"question",placeholder:"Question non ambiguë",required:""},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}})])]),t.choices.length>0?n("div",{staticClass:"mb-5 col-6 mx-auto"},[n("h4",[t._v("Propositions")]),n("div",{attrs:{id:"propositions"}},[n("MultiInput",{attrs:{initialValues:t.choices,notEnough:t.notEnoughChoices},on:{childToParent:t.updateChoices}})],1)]):t._e(),t.isNew&&!t.userIsLogged?n("div",{staticClass:"mb-5 col-6 mx-auto"},[n("h4",[t._v("Suppression")]),n("label",{attrs:{for:""}},[t._v("Après")]),n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.pickedDelay,expression:"pickedDelay"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"one",name:"limit"},domProps:{value:1,checked:t._q(t.pickedDelay,1)},on:{change:function(e){t.pickedDelay=1}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"one"}},[t._v("1 jour")])]),n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.pickedDelay,expression:"pickedDelay"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"two",name:"limit"},domProps:{value:2,checked:t._q(t.pickedDelay,2)},on:{change:function(e){t.pickedDelay=2}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"two"}},[t._v("2 jours")])]),n("div",{staticClass:"custom-control custom-radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.pickedDelay,expression:"pickedDelay"}],staticClass:"custom-control-input",attrs:{type:"radio",id:"seven",name:"limit"},domProps:{value:7,checked:t._q(t.pickedDelay,7)},on:{change:function(e){t.pickedDelay=7}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"seven"}},[t._v("7 jours")])])]):t._e(),n("div",{staticClass:"d-flex"},[t.isNew?t._e():n("button",{staticClass:"btn btn-outline-success mr-1",attrs:{id:"saveVote",type:"button"},on:{click:t.saveVote}},[t._v("Enregistrer")]),n("button",{staticClass:"btn btn-light ml-1",attrs:{type:"button"},on:{click:t.cancelModifications}},[t._v("Annuler")]),n("button",{staticClass:"btn btn-primary ml-auto",attrs:{id:"publishVote",type:"submit"}},[t._v("Ouvrir le vote")])])])])},mt=[],pt=(n("a4d3"),n("e01a"),n("d81d"),n("13d5"),n("5530")),vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[t._l(t.values,(function(e,r){return n("div",{key:"val_"+r,staticClass:"w-100 d-flex justify-content-between mb-2 mx-auto"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.val,expression:"item.val"}],staticClass:"form-control",class:{"is-invalid":t.notEnough},attrs:{type:"text",placeholder:"Proposition "+(r+1)},domProps:{value:e.val},on:{input:[function(n){n.target.composing||t.$set(e,"val",n.target.value)},function(e){return t.updateValue()}]}}),n("button",{staticClass:"btn btn-outline-danger m-0 ml-1",attrs:{type:"button"},on:{click:function(e){return t.removeValue(r)}}},[n("font-awesome-icon",{attrs:{icon:["far","trash-alt"]}})],1)])})),t.notEnough?n("div",{staticClass:"text-danger small text-left mb-3"},[t._v(" Pas assez de propositions ")]):t._e(),n("button",{staticClass:"btn btn-outline-info btn-sm m-0",attrs:{type:"button",id:"addProposition"},on:{click:function(e){return t.addValue()}}},[t._v("Ajouter une alternative")])],2)},ft=[],ht=(n("a434"),{name:"MultiInput",props:{childToParent:Function,initialValues:Array,notEnough:Boolean},data:function(){return{values:this.initialValues}},watch:{values:function(t){this.$emit("childToParent",t)}},methods:{addValue:function(){this.values.push({}),this.$emit("input",this.values)},removeValue:function(t){this.values.length>1&&(this.values.splice(t,1),this.$emit("input",this.values))},updateValue:function(){this.$emit("input",this.values)}}}),bt=ht,gt=(n("1615"),Object(b["a"])(bt,vt,ft,!1,null,"d14f4a6a",null)),Ct=gt.exports,_t={name:"EditVote",components:{MultiInput:Ct,MainCardContainer:it},mixins:[C],data:function(){return{API_URL:"https://ireneburlet.fr/votonapi/api/",isNew:"EditVote"!==this.$route.name,userIsLogged:!!localStorage.getItem("currentUser"),currentUser:JSON.parse(localStorage.getItem("currentUser")),token:localStorage.getItem("user-token"),vote:{},title:"",user_id:null,description:"",status:1,openDate:null,nbChoices:0,deleteDate:null,pickedDelay:1,choices:[],notEnoughChoices:!1,loading:!0}},created:function(){var t=this;this.isNew?(this.choices=[{val:""},{val:""}],this.loading=!1):this.findRecord("votes",{filter:{_id:this.$route.params.vote_id}}).then((function(e){t.vote=e.data.entries[0],t.vote.nbChoices>0?t.findRecord("choices",{filter:{vote_id:t.$route.params.vote_id}}).then((function(e){t.choices=e.data.entries.map((function(t){return{val:t.name}}))})):t.choices=[{val:""},{val:""}],t.title=t.vote.title,t.user_id=t.vote.user_id,t.description=t.vote.description,t.status=t.vote.status,t.openDate=t.vote.openDate,t.nbChoices=t.vote.nbChoices,t.deleteDate=t.vote.deleteDate||null,t.loading=!1})).catch((function(t){console.error(t)}))},methods:{updateChoices:function(t){this.choices=t},addDays:function(t,e){var n=new Date(t);return n.setDate(n.getDate()+e),n},cancelModifications:function(){confirm("Êtes-vous sûr de vouloir perdre vos modifications ?")&&(this.currentUser?this.$router.push("/account/"+this.currentUser._id).catch((function(t){throw new Error("Problem handling something : "+t)})):this.$router.push("/").catch((function(t){throw new Error("Problem handling something : "+t)})))},getDatas:function(t){var e=Object(pt["a"])({},t,{_id:this.vote._id,title:this.title,user_id:this.user_id||"5e8ca11b98e27a43f37ab051",description:this.description,openDate:this.openDate||new Date,nbChoices:this.choices.reduce((function(t,e){return t+(e.val?1:0)}),0),nbBulletins:0,deleteDate:this.isNew&&!this.userIsLogged?this.addDays(this.openDate,this.pickedDelay):null});return e},saveVote:function(){var t=this.getDatas({status:this.status});this.saveModifications(t)},openVote:function(t){if(t.preventDefault(),confirm("Êtes-vous sûre de vouloir ouvrir le vote ? Vous ne pourrez plus modifier après.")){var e=this.getDatas({status:1});e.nbChoices<2?this.notEnoughChoices=!0:this.saveModifications(e,!0)}},saveModifications:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.createOrSaveRecord("votes",Object(pt["a"])({},t)).then(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(r){var o,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=r.data,!(o.nbChoices>0)){t.next=4;break}return t.next=4,e.removeRecord("choices",{vote_id:o._id}).catch((function(t){return console.error(t)}));case 4:a=Object(H["a"])(e.choices),t.prev=5,a.s();case 7:if((i=a.n()).done){t.next=20;break}if(s=i.value,!s.val){t.next=18;break}return t.prev=10,t.next=13,e.createOrSaveRecord("choices",{vote_id:o._id,nbNote1:"0",nbNote2:"0",nbNote3:"0",nbNote4:"0",nbNote5:"0",nbNote6:"0",name:s.val});case 13:t.next=18;break;case 15:throw t.prev=15,t.t0=t["catch"](10),new Error("Problem handling something : "+t.t0);case 18:t.next=7;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](5),a.e(t.t1);case 25:return t.prev=25,a.f(),t.finish(25);case 28:e.$router.push(n?"/vote/"+o._id:"/").catch((function(t){throw new Error("Problem handling something : "+t)}));case 29:case"end":return t.stop()}}),t,null,[[5,22,25,28],[10,15]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){console.error(t)}))}}},wt=_t,xt=Object(b["a"])(wt,dt,mt,!1,null,null,null),yt=xt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main-card-container",[n("div",{staticClass:"w-100",attrs:{slot:"content"},slot:"content"},[n("small-card-form",{attrs:{title:"Démarrer un vote",buttonSubmitText:"Créer un vote",submitMethod:t.createVote,customClass:"col-6 mb-5 mx-auto bg-white"}},[n("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[n("label",{attrs:{for:"newVote-title"}},[t._v("Titre")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.voteTitle,expression:"voteTitle"}],staticClass:"form-control",attrs:{type:"text",id:"newVote-title",placeholder:"Titre de votre vote",name:"newVote-title",maxlength:"30",pattern:"([^'\\x22]{1,})+",title:"Pas d'apostrophes autorisées",required:""},domProps:{value:t.voteTitle},on:{input:function(e){e.target.composing||(t.voteTitle=e.target.value)}}})]),n("div",{staticClass:"form-group text-left",attrs:{slot:"input"},slot:"input"},[n("label",{attrs:{for:"newVote-question"}},[t._v("Question")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.voteQuestion,expression:"voteQuestion"}],staticClass:"form-control",attrs:{type:"text",id:"newVote-question",placeholder:"Saisissez une question non ambigüe",name:"newVote-question",pattern:"([^'\\x22])++",title:"Pas d'apostrophes autorisées",required:""},domProps:{value:t.voteQuestion},on:{input:function(e){e.target.composing||(t.voteQuestion=e.target.value)}}})])]),n("PreviewCardsList",{attrs:{list:t.inprogressVotes,titleList:"En cours",singulier:"en cours"}}),n("PreviewCardsList",{attrs:{list:t.closedVotes,choices:t.winningChoices,titleList:"Fermés",singulier:"fermé"}}),n("PreviewCardsList",{attrs:{list:t.archivedVotes,titleList:"Archivés",singulier:"archivé"}})],1)])},kt=[],St=(n("4de4"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"col-10 mx-auto text-left mb-5"},[n("h5",{staticClass:"ml-3"},[t._v(t._s(t.titleList))]),t.list.length?n("div",{staticClass:"d-flex flex-wrap"},t._l(t.list,(function(e){return n("div",{key:e._id,staticClass:"col-6"},[n("VotePreviewCard",{attrs:{title:e.title,state:t.voteState(e),info:t.infoVote(e),link:t.linkVote(e),winningChoice:t.getWinningChoice(e._id),stateColor:t.colorStatus(e)}})],1)})),0):n("div",{staticClass:"col-12"},[t._v("Pas de vote "+t._s(t.singulier)+" ")])])}),Pt=[],Vt=(n("7db0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{staticClass:"card mx-0 py-1 px-3 mb-2 text-decoration-none",attrs:{to:t.link}},[n("span",{staticClass:"text-open my-2 font-weight-normal",class:t.stateColor},[t._v(t._s(t.state))]),n("div",[n("h5",{staticClass:"float-left font-weight-bold text-dark"},[t._v(t._s(t.title))]),n("span",{staticClass:"float-right"},[t._v(t._s(t.info))]),n("span",{staticClass:"float-right"},[t._v(t._s(t.winningChoice))]),n("div",{staticStyle:{clear:"both"}})])])}),Ot=[],jt={name:"VotePreviewCard",props:{title:{type:String,required:!0},info:{type:String,required:!0},state:{type:String,required:!0},link:{type:String,required:!0},winningChoice:{type:String,required:!1,default:function(){return""}},stateColor:{type:String,required:!1,default:"text-primary"}}},Ut=jt,Mt=Object(b["a"])(Ut,Vt,Ot,!1,null,"a54d60b4",null),Lt=Mt.exports,Et={name:"PreviewCardsList",components:{VotePreviewCard:Lt},props:{list:{type:Array,default:function(){return[]}},choices:{type:Array,default:function(){return[]}},titleList:String,singulier:String},methods:{voteState:function(t){return 0==t.status?"Non publié":1==t.status?"Ouvert":2==t.status?"Fermé":3==t.status?"Archivé":""},infoVote:function(t){return 0==t.status?"Éditer":1==t.status?t.nbBulletins+" bulletin"+(t.nbBulletins>1?"s":""):""},linkVote:function(t){return(0==t.status?"/edit/":"/vote/")+t._id},getWinningChoice:function(t){var e=this.choices.find((function(e){return e.vote_id==t}));return e?e.name:""},colorStatus:function(t){return 0==t.status?"text-primary":1==t.status?"text-success":2==t.status?"text-danger":3==t.status?"text-warning":"text-primary"}}},Nt=Et,Rt=Object(b["a"])(Nt,St,Pt,!1,null,"5e60eeab",null),Dt=Rt.exports,qt={name:"Account",components:{SmallCardForm:R,PreviewCardsList:Dt,MainCardContainer:it},mixins:[C],data:function(){return{API_URL:"https://ireneburlet.fr/votonapi/api/",token:localStorage.getItem("user-token"),currentUser:JSON.parse(localStorage.getItem("currentUser")),voteTitle:null,voteQuestion:null,inprogressVotes:[],closedVotes:[],archivedVotes:[],winningChoices:[]}},created:function(){this.getInProgressVotes(),this.getClosedVote()},methods:{getInProgressVotes:function(){var t=this;this.findRecord("votes",{filter:{user_id:this.currentUser._id,status:{$in:[0,1]}},sort:{_modified:-1}}).then((function(e){return t.inprogressVotes=e.data.entries})).catch((function(t){return console.error(t)}))},getClosedVote:function(){var t=this;this.findRecord("votes",{filter:{user_id:this.currentUser._id,status:2},sort:{_modified:-1}}).then((function(e){t.closedVotes=e.data.entries;var n=e.data.entries.map((function(t){return t.winningChoice_id})).filter((function(t){return!!t}));t.findRecord("choices",{filter:{_id:{$in:n}}}).then((function(e){return t.winningChoices=e.data.entries})).catch((function(t){return console.error(t)}))})).catch((function(t){return console.error(t)}))},createVote:function(){var t=this;this.createOrSaveRecord("votes",{title:this.voteTitle,description:this.voteQuestion,user_id:this.currentUser._id,creationDate:new Date,status:0,nbBulletins:0,nbChoices:0}).then((function(e){return t.$router.push("/edit/"+e.data._id).catch((function(t){return console.error(t)}))})).catch((function(t){return console.error(t)}))}}},It=qt,Bt=Object(b["a"])(It,At,kt,!1,null,null,null),Tt=Bt.exports,Ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},Qt=[],Ht={name:"Settings"},Jt=Ht,Wt=Object(b["a"])(Jt,Ft,Qt,!1,null,"6393997a",null),zt=Wt.exports,Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"my-auto"},[n("div",{staticClass:"text-right bg-primary text-white d-flex"},[n("font-awesome-icon",{attrs:{icon:["fas","person-booth"],size:"6x"}}),n("p",{staticClass:"d-inline"},[t._v(" Nous avons l’habitude de voter avec le mode de scrutin uni-nominatif à 1 ou 2 tours : parmi plusieurs propositions, un votant donne 1 seule voix “pour”, la proposition avec le plus de voix l’emporte, le 2ème tour servant à dégager une majorité. Or cela fait depuis le 18eme siècle que l’on connaît les nombreuses faiblesses de ce mode de scrutin : les voix de protestation mélangées aux voix d’adhésion (ou pire : ignorées), le nombre de propositions divise les voix, le vote utile qui parasite nos choix objectifs, l’illusion de “majorité” du deuxième tour, la lecture extrêmement binaire de l’opinion des votants. A l’heure des algorithmes ultra-complexe, c’est difficilement défendable. Imaginez simplement que l’on puisse mettre 1 bulletin “Pour” et 1 bulletin “Contre”. Ou bien que l’on puisse mettre 2 ou 3 bulletins. Ou bien qu’on puisse voter comme au cinéma avec 1 avec des notes nuancées pour chaque proposition. Les élections auraient des résultats bien différents. ")])],1),t._m(0),t._m(1)])},Kt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-right bg-light"},[n("p",[t._v(" Le mode de scrutin majoritaire balaye tous ces défauts : les votants attribuent une mention à toutes les propositions, parmi 6 mentions allant de “A rejeter” à “Excellent”, la proposition qui satisfait le mieux plus de 50% des votants l’emporte. c’est une vraie majorité pas besoin de 2ême tour le vote utile n’a plus lieu d’être puisque chaque proposition est jugée indépendamment les voix de protestations sont entendues et ont la même valeur que les voix d’adhésion les voix sont nuancées l’opinion des votants est très lisible Ce mode de scrutin a été inventé par deux mathématiciens Français, chercheurs au CNRS, M.Balinski et R.Laraki. ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-left"},[n("p",[t._v(" L’essayer c’est l’adopter ! C’est une totale réécriture de la conception d’une démocratie, du vivre ensemble, de la communication, ainsi qu’une mise à jour drastique des moyens à notre disposition pour faire les bons choix. Pour approfondir, voici une petite bande dessinée qui présente avec brio tous les principes du scrutin majoritaire et les questionnements qui ont amené à sa conception : https://www.lechoixcommun.fr/content/article/vous-reprendrez-bien-un-peu-de-democratie.html "),n("br"),n("br"),t._v(" [raccourci] Créer gratuitement mon 1er vote ")])])}],Yt={name:"MajorityVote"},Xt=Yt,Zt=(n("2bde"),Object(b["a"])(Xt,Gt,Kt,!1,null,"250ad5cf",null)),$t=Zt.exports;s["a"].use(V["a"]);var te=[{path:"/",name:"Home",component:T,beforeEnter:function(t,e,n){localStorage.getItem("currentUser")?n("/account/"+JSON.parse(localStorage.getItem("currentUser"))._id):n()}},{path:"/vote/new",name:"CreateAnonymVote",component:yt},{path:"/scrutin-majoritaire",name:"MajorityVote",component:$t},{path:"/vote/:vote_id",name:"Vote",component:lt},{path:"/edit/:vote_id",name:"EditVote",component:yt},{path:"/account/:user_id",name:"Account",component:Tt,beforeEnter:function(t,e,n){var r=JSON.parse(localStorage.getItem("currentUser"));t.params.user_id!==r._id?n({name:"Home"}):n()},children:[{path:":vote_id",component:lt},{path:"settings",component:zt}]},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],ee=new V["a"]({routes:te}),ne=ee,re=n("9483");Object(re["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});n("4989"),n("ab8b");var oe=n("ecee"),ae=n("c074"),ie=n("b702"),se=n("ad3d");oe["c"].add(ae["c"]),oe["c"].add(ae["f"]),oe["c"].add(ie["c"]),oe["c"].add(ie["b"]),oe["c"].add(ie["a"]),oe["c"].add(ae["g"]),oe["c"].add(ae["e"]),oe["c"].add(ae["a"]),oe["c"].add(ae["b"]),oe["c"].add(ae["d"]),s["a"].component("font-awesome-icon",se["a"]),s["a"].config.productionTip=!1,new s["a"]({router:ne,render:function(t){return t(P)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},"97fd":function(t,e,n){},"9c0c":function(t,e,n){},af35:function(t,e,n){},cf61:function(t,e,n){},d1b4:function(t,e,n){"use strict";var r=n("2bb7"),o=n.n(r);o.a},d435:function(t,e,n){},f4b0:function(t,e,n){"use strict";var r=n("d435"),o=n.n(r);o.a}});
//# sourceMappingURL=app.4c57f292.js.map